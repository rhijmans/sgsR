<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Learn how to use calculate_* functions.
">
<title>calculating â€¢ sgsR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="calculating">
<meta property="og:description" content="Learn how to use calculate_* functions.
">
<meta property="og:image" content="/reference/figures/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-115082821-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-115082821-1');
</script><script defer data-domain="pkgdown.r-lib.org,all.tidyverse.org" src="https://plausible.io/js/plausible.js"></script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">sgsR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/sgsR.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/calculating.html">calculating</a>
    <a class="dropdown-item" href="../articles/sampling.html">sampling</a>
    <a class="dropdown-item" href="../articles/stratification.html">stratification</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/tgoodbody/sgsR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>calculating</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/tgoodbody/sgsR/blob/HEAD/vignettes/calculating.Rmd" class="external-link"><code>vignettes/calculating.Rmd</code></a></small>
      <div class="d-none name"><code>calculating.Rmd</code></div>
    </div>

    
    
<p>A total of 7 <code>calculate</code> functions currently exist in the
package:</p>
<ul>
<li><p><code><a href="../reference/calculate_representation.html">calculate_representation()</a></code> - compare representation
of strata in existing sample</p></li>
<li><p><code><a href="../reference/calculate_distance.html">calculate_distance()</a></code> - per pixel distance to closest
access vector</p></li>
<li><p><code><a href="../reference/calculate_pcomp.html">calculate_pcomp()</a></code>- principal components on input
<code>mraster</code></p></li>
<li><p><code><a href="../reference/calculate_sampsize.html">calculate_sampsize()</a></code> - Determine appropriate sample
sizes based on relative standard error thresholds</p></li>
<li><p><code><a href="../reference/calculate_allocation.html">calculate_allocation()</a></code> - sample allocation algorithm
- proportional / optimal / equal sampling</p></li>
<li><p><code><a href="../reference/calculate_coobs.html">calculate_coobs()</a></code> - Count of observations
algorithm</p></li>
<li><p><code><a href="../reference/calculate_pop.html">calculate_pop()</a></code> - Population covariate statistics
for latin hypercube sampling</p></li>
<li><p><code><a href="../reference/calculate_lhsOpt.html">calculate_lhsOpt()</a></code> - Optimal latin hypercube
sampling paramters including sample number</p></li>
</ul>
<p><code>calculate_*</code> functions serve as helper functions. In this
section we outline how these functions can be used.</p>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="rep">
<code>calculate_representation()</code><a class="anchor" aria-label="anchor" href="#rep"></a>
</h2>
<p>The <code><a href="../reference/calculate_representation.html">calculate_representation()</a></code> function allows users to
check how well represented their <code>existing</code> sample networks
are within the context of a stratification. Users provide an
<code>sraster</code> of their choosing and their <code>existing</code>
samples are are provided with a tabular and graphical (if
<code>plot = TRUE</code>) output comparing strata coverage frequency and
sampling frequency.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#--- calculate representation ---#</span>
<span class="fu"><a href="../reference/calculate_representation.html">calculate_representation</a></span><span class="op">(</span>sraster <span class="op">=</span> <span class="va">sraster</span>, 
                         existing <span class="op">=</span> <span class="va">existing</span>, 
                         plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="calculating_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<pre><code><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 x 6</span></span>
<span class="co">#&gt;   strata srasterFreq sampleFreq diffFreq nSamp  need</span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span>      1        0.29       0.28  -<span style="color: #BB0000;">0.010</span><span style="color: #BB0000; text-decoration: underline;">0</span>    56     2</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span>      2        0.27       0.23  -<span style="color: #BB0000;">0.04</span>      47     7</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span>      3        0.24       0.25   0.010<span style="text-decoration: underline;">0</span>    50    -<span style="color: #BB0000;">2</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span>      4        0.21       0.23   0.020<span style="text-decoration: underline;">0</span>    47    -<span style="color: #BB0000;">5</span></span></code></pre>
<p>The tabular output outlines the frequency of coverage for each strata
(<code>srasterFreq</code>) and the sampling frequency within each strata
(<code>sampleFreq</code>). The difference between these
(<code>diffFreq</code>) determine whether values are over-represented
(positive numbers) or under-represented (negative numbers). This is also
reflected in the number of samples that are needed to be added or
removed (<code>need</code>) to reach what would be considered a sample
that is representative of the strata provided in
<code>sraster</code>.</p>
<p>Performing the algorithm on a sample set derived using
<code><a href="../reference/sample_strat.html">sample_strat()</a></code> demonstrates proportional sampling to strata
coverage.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#--- stratified samples ---#</span>
<span class="va">strat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sample_strat.html">sample_strat</a></span><span class="op">(</span>sraster <span class="op">=</span> <span class="va">sraster</span>,
                      nSamp <span class="op">=</span> <span class="fl">200</span><span class="op">)</span>

<span class="fu"><a href="../reference/calculate_representation.html">calculate_representation</a></span><span class="op">(</span>sraster <span class="op">=</span> <span class="va">sraster</span>,
                         existing <span class="op">=</span> <span class="va">strat</span>,
                         plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="calculating_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<pre><code><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 x 6</span></span>
<span class="co">#&gt;   strata srasterFreq sampleFreq diffFreq nSamp  need</span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span>      1        0.29       0.29        0    58     1</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span>      2        0.27       0.27        0    54     1</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span>      3        0.24       0.24        0    48     1</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span>      4        0.21       0.21        0    42     1</span></code></pre>
<p>It is common for there to be very small (negligible) differences
between <code>srasterFreq</code> and <code>sampleFreq</code>. In these
cases its important for the user to determine whetehr they think samples
should really be added or removed.</p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="dist">
<code>calculate_distance</code><a class="anchor" aria-label="anchor" href="#dist"></a>
</h2>
<p>The <code><a href="../reference/calculate_distance.html">calculate_distance()</a></code> function takes input
<code>raster</code> and <code>access</code> data and outputs a per pixel
distance to the nearest access point. This function has particular value
for constraining sampling protocols such the <code><a href="../reference/sample_clhs.html">sample_clhs()</a></code>
function where the output raster layer can be used as a
<code>cost</code> constraint.The output raster is the input with the
calculated distance layer (<code>dist2access</code>) appended.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/calculate_distance.html">calculate_distance</a></span><span class="op">(</span>raster <span class="op">=</span> <span class="va">sraster</span>, <span class="co"># input</span>
                   access <span class="op">=</span> <span class="va">access</span>, <span class="co"># define access road network</span>
                   plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># plot</span></code></pre></div>
<p><img src="calculating_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<pre><code><span class="co">#&gt; class       : SpatRaster </span>
<span class="co">#&gt; dimensions  : 277, 373, 2  (nrow, ncol, nlyr)</span>
<span class="co">#&gt; resolution  : 20, 20  (x, y)</span>
<span class="co">#&gt; extent      : 431100, 438560, 5337700, 5343240  (xmin, xmax, ymin, ymax)</span>
<span class="co">#&gt; coord. ref. : UTM Zone 17, Northern Hemisphere </span>
<span class="co">#&gt; sources     : memory  </span>
<span class="co">#&gt;               memory  </span>
<span class="co">#&gt; names       :      strata, dist2access </span>
<span class="co">#&gt; min values  : 1.000000000, 0.006621213 </span>
<span class="co">#&gt; max values  :        4.00,     1061.66</span></code></pre>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="calculate_pcomp">
<code>calculate_pcomp</code><a class="anchor" aria-label="anchor" href="#calculate_pcomp"></a>
</h2>
<p>The <code><a href="../reference/calculate_pcomp.html">calculate_pcomp()</a></code> function take a
<code>mraster</code> as input and performs principal component analysis.
The number of components defined by the <code>nComp</code> parameter
specify the number of components that should be rasterized to
output.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/calculate_pcomp.html">calculate_pcomp</a></span><span class="op">(</span>mraster <span class="op">=</span> <span class="va">mraster</span>, <span class="co"># input</span>
                nComp <span class="op">=</span> <span class="fl">3</span>, <span class="co"># number of components to output</span>
                plot <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># plot</span>
                details <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># details about the principal component analysis appended</span></code></pre></div>
<p><img src="calculating_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<pre><code><span class="co">#&gt; $pca</span>
<span class="co">#&gt; Standard deviations (1, .., p=7):</span>
<span class="co">#&gt; [1] 2.39419739 0.86118253 0.65363210 0.27245666 0.11010541 0.10829035</span>
<span class="co">#&gt; [7] 0.02942688</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Rotation (n x k) = (7 x 7):</span>
<span class="co">#&gt;                PC1         PC2         PC3         PC4         PC5</span>
<span class="co">#&gt; zmean    0.4133340  0.09703826 -0.16916047  0.05442900 -0.21939815</span>
<span class="co">#&gt; pzabove2 0.3217898  0.28579795  0.89947473  0.04704228  0.05896495</span>
<span class="co">#&gt; zsd      0.3314085 -0.70018256  0.06658857 -0.06471159  0.60912694</span>
<span class="co">#&gt; zq20     0.3511227  0.56045175 -0.30858934 -0.47871051  0.46478505</span>
<span class="co">#&gt; zq50     0.4055046  0.12094513 -0.21087080  0.55459689 -0.06283654</span>
<span class="co">#&gt; zq70     0.4116799 -0.07298152 -0.13366415  0.36834483 -0.07728656</span>
<span class="co">#&gt; zq90     0.3982126 -0.29083896  0.01832844 -0.56410773 -0.59279438</span>
<span class="co">#&gt;                   PC6          PC7</span>
<span class="co">#&gt; zmean     0.054431518  0.858523411</span>
<span class="co">#&gt; pzabove2 -0.004537764  0.002374888</span>
<span class="co">#&gt; zsd      -0.102288428  0.098957671</span>
<span class="co">#&gt; zq20      0.029772877 -0.145958963</span>
<span class="co">#&gt; zq50     -0.629629712 -0.261748068</span>
<span class="co">#&gt; zq70      0.755801174 -0.307312042</span>
<span class="co">#&gt; zq90     -0.134157677 -0.262454817</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $raster</span>
<span class="co">#&gt; class       : SpatRaster </span>
<span class="co">#&gt; dimensions  : 277, 373, 3  (nrow, ncol, nlyr)</span>
<span class="co">#&gt; resolution  : 20, 20  (x, y)</span>
<span class="co">#&gt; extent      : 431100, 438560, 5337700, 5343240  (xmin, xmax, ymin, ymax)</span>
<span class="co">#&gt; coord. ref. : UTM Zone 17, Northern Hemisphere </span>
<span class="co">#&gt; sources     : memory  </span>
<span class="co">#&gt;               memory  </span>
<span class="co">#&gt;               memory  </span>
<span class="co">#&gt; names       :       PC1,       PC2,       PC3 </span>
<span class="co">#&gt; min values  : -5.841778, -6.368110, -4.038303 </span>
<span class="co">#&gt; max values  :  7.804354,  2.563877,  1.633331</span></code></pre>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="calculate_sampsize">
<code>calculate_sampsize</code><a class="anchor" aria-label="anchor" href="#calculate_sampsize"></a>
</h2>
<p>The <code><a href="../reference/calculate_sampsize.html">calculate_sampsize()</a></code> function allows users to
determine what an appropriate sample size would be using the relative
standard error of input metric. If an <code>mraster</code> with multiple
layers is provided, sample sizes will be determined for all layers. If
<code>plot = TRUE</code> and <code>rse</code> is defined, a sequence of
rse values will be visualized with indicators and a value for the
matching sample size.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#--- determine sample size based on relative standard error (rse) of 1% ---#</span>
<span class="fu"><a href="../reference/calculate_sampsize.html">calculate_sampsize</a></span><span class="op">(</span>mraster <span class="op">=</span> <span class="va">mraster</span>,
                   rse <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span>
<span class="co">#&gt;   nSamp  rse      var</span>
<span class="co">#&gt; 1  2030 0.01    zmean</span>
<span class="co">#&gt; 2  1341 0.01 pzabove2</span>
<span class="co">#&gt; 3  1859 0.01      zsd</span>
<span class="co">#&gt; 4  3647 0.01     zq20</span>
<span class="co">#&gt; 5  2581 0.01     zq50</span>
<span class="co">#&gt; 6  2110 0.01     zq70</span>
<span class="co">#&gt; 7  1394 0.01     zq90</span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#--- change default threshold sequence values ---# </span>
<span class="co">#--- if increment and rse are not divisible the closest value will be taken ---#</span>
<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_sampsize.html">calculate_sampsize</a></span><span class="op">(</span>mraster <span class="op">=</span> <span class="va">mraster</span>,
                   rse <span class="op">=</span> <span class="fl">0.025</span>,
                   start <span class="op">=</span> <span class="fl">0.01</span>,
                   end <span class="op">=</span> <span class="fl">0.08</span>,
                   increment <span class="op">=</span> <span class="fl">0.01</span>,
                   plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; 'rse' not perfectly divisible by 'incremenent. </span>
<span class="co">#&gt; Selecting closest sample size (rse = 0.03) based on values.</span>

<span class="va">p</span>
<span class="co">#&gt; $nSamp</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 7 x 3</span></span>
<span class="co">#&gt; <span style="color: #949494;"># Groups:   var [7]</span></span>
<span class="co">#&gt;   nSamp   rse var     </span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span>   230  0.03 zmean   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span>   151  0.03 pzabove2</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span>   211  0.03 zsd     </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span>   421  0.03 zq20    </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">5</span>   295  0.03 zq50    </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">6</span>   240  0.03 zq70    </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">7</span>   157  0.03 zq90    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $plot</span></code></pre></div>
<p><img src="calculating_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="calculate_allocation">
<code>calculate_allocation</code><a class="anchor" aria-label="anchor" href="#calculate_allocation"></a>
</h2>
<p>The <code><a href="../reference/calculate_allocation.html">calculate_allocation()</a></code> function calculates the total
number of samples that should be allocated for sampling based on a total
sample value (<code>nSamp</code>) and an input <code>sraster</code>.
This function is utilized in a number of functions including <a href="#strat"><code>sample_strat</code></a>. Three methods for
allocation are currently included: proportional (<code>prop</code>;
default), optimal (<code>optim</code>) allocation, and equal
(<code>equal</code>) allocation.</p>
<ul>
<li>Proportional - Samples are allocated based on the area coverage of
strata. This is the default method.</li>
<li>Optimal - Samples are allocated based on the within strata
variation.</li>
<li>Equal - The same number of samples (<code>nSamp</code>) are
allocated to each strata.</li>
</ul>
<div class="section level3 unnumbered">
<h3 class="unnumbered" id="proportional">Proportional allocation<a class="anchor" aria-label="anchor" href="#proportional"></a>
</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#--- perform grid sampling ---#</span>
<span class="fu"><a href="../reference/calculate_allocation.html">calculate_allocation</a></span><span class="op">(</span>sraster <span class="op">=</span> <span class="va">sraster</span>, 
                     nSamp <span class="op">=</span> <span class="fl">200</span><span class="op">)</span>
<span class="co">#&gt;   strata total</span>
<span class="co">#&gt; 1      1    58</span>
<span class="co">#&gt; 2      2    54</span>
<span class="co">#&gt; 3      3    48</span>
<span class="co">#&gt; 4      4    42</span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#--- calculate existing samples to include ---#</span>
<span class="va">e.sr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_strata.html">extract_strata</a></span><span class="op">(</span>sraster <span class="op">=</span> <span class="va">sraster</span>, 
                       existing <span class="op">=</span> <span class="va">existing</span><span class="op">)</span>

<span class="fu"><a href="../reference/calculate_allocation.html">calculate_allocation</a></span><span class="op">(</span>sraster <span class="op">=</span> <span class="va">sraster</span>, 
                     nSamp <span class="op">=</span> <span class="fl">200</span>, 
                     existing <span class="op">=</span> <span class="va">e.sr</span><span class="op">)</span>
<span class="co">#&gt;   strata total need</span>
<span class="co">#&gt; 1      1     2   58</span>
<span class="co">#&gt; 2      2     7   54</span>
<span class="co">#&gt; 3      3    -2   48</span>
<span class="co">#&gt; 4      4    -5   42</span></code></pre></div>
<p>Notice that some of the results in <code>total</code> above are
negative. This indicates that the <code>existing</code> samples over
represent those strata and that some samples should be removed to avoid
over representation. The number that should be added/removed is details
in <code>$total</code>.</p>
</div>
<div class="section level3 unnumbered">
<h3 class="unnumbered" id="optimal">Optimal Allocation<a class="anchor" aria-label="anchor" href="#optimal"></a>
</h3>
<p>Optimal allocation utilizes within strata metric variation to
allocate samples. This means that in addition to providing and
<code>sraster</code>, that a specific metric (<code>mraster</code>) must
be provided to calculate variation to optimally allocate samples.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/calculate_allocation.html">calculate_allocation</a></span><span class="op">(</span>sraster <span class="op">=</span> <span class="va">sraster</span>, <span class="co"># stratified raster</span>
                     nSamp <span class="op">=</span> <span class="fl">200</span>, <span class="co"># desired sample number</span>
                     existing <span class="op">=</span> <span class="va">e.sr</span>, <span class="co">#existing samples</span>
                     allocation <span class="op">=</span> <span class="st">"optim"</span>, <span class="co"># optimal allocation</span>
                     mraster <span class="op">=</span> <span class="va">mraster</span><span class="op">$</span><span class="va">zq90</span>, <span class="co"># metric raster</span>
                     force <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># force nSamp number</span>
<span class="co">#&gt;   strata total need</span>
<span class="co">#&gt; 1      1    -7   49</span>
<span class="co">#&gt; 2      2     4   51</span>
<span class="co">#&gt; 3      3     7   60</span>
<span class="co">#&gt; 4      4    -4   43</span></code></pre></div>
</div>
<div class="section level3 unnumbered">
<h3 class="unnumbered" id="equal">Equal allocation<a class="anchor" aria-label="anchor" href="#equal"></a>
</h3>
<p>There may be an instance where a user wants to have the same number
of samples allocated to each strata. In this case using
<code>allocation = equal</code> is ideal. In this instance,
<code>nSamp</code> relates to the total number of samples per strata
rather than the total number of samples overall.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/calculate_allocation.html">calculate_allocation</a></span><span class="op">(</span>sraster <span class="op">=</span> <span class="va">sraster</span>, <span class="co"># stratified raster</span>
                     nSamp <span class="op">=</span> <span class="fl">20</span>, <span class="co"># desired sample number</span>
                     allocation <span class="op">=</span> <span class="st">"equal"</span><span class="op">)</span> <span class="co"># optimal allocation</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 x 2</span></span>
<span class="co">#&gt;   strata total</span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span>      1    20</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span>      2    20</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span>      3    20</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span>      4    20</span></code></pre></div>
<p>That yields a total of 80 samples (20 <code>nSamp</code> for each of
the 4 strata in <code>sraster</code>.)</p>
</div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="sampeval">Sample evaluation algorithms<a class="anchor" aria-label="anchor" href="#sampeval"></a>
</h2>
<p>The following algorithms were initially developed by Dr.Â Brendan
Malone from the University of Sydney. In their work they graciously
provided an in depth description of the functionality of these
algorithms that were originally developed to improve soil sampling
strategies. These functions have been modified and implemented so they
can be used for structurally guided sampling approaches. Many thanks to
Dr.Â Malone for being an excellent collaborator and proponent of open
source algorithms.</p>
<p>Please consult the original reference for these ideas and scripts as
they are extremely valuable and helpful for understanding their sampling
rationale.</p>
<p><em>Malone BP, Minansy B, Brungard C. 2019. Some methods to improve
the utility of conditioned Latin hypercube sampling. PeerJ 7:e6451 DOI
10.7717/peerj.6451</em></p>
<div class="section level3 unnumbered">
<h3 class="unnumbered" id="coobs">
<code>calculate_coobs</code><a class="anchor" aria-label="anchor" href="#coobs"></a>
</h3>
<p>The <code><a href="../reference/calculate_coobs.html">calculate_coobs()</a></code> function perform the COunt of
OBServations (coobs) algorithm using <code>existing</code> sample data
and <code>mraster</code> covariates. This algorithm aids the user in
understanding how an <code>existing</code> sample data set is
distributed among the landscape with relation to <code>mraster</code>
covariates. The output coobs raster could be used to constrain clhs
sampling using the <code><a href="../reference/sample_clhs.html">sample_clhs()</a></code> to areas that are under
reprented.</p>
<p>The coobs raster determines how many observations are similar in
terms of the covariate space at every pixel.This fucntion takes
advantage of parallel processing routines.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/calculate_coobs.html">calculate_coobs</a></span><span class="op">(</span>mraster <span class="op">=</span> <span class="va">mraster</span>, <span class="co"># input</span>
                existing <span class="op">=</span> <span class="va">existing</span>, <span class="co"># existing samples</span>
                cores <span class="op">=</span> <span class="fl">4</span>, <span class="co"># parallel cores to use</span>
                details <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># provide details from algorithm output</span>
                plot <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># plot</span>
                filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".tif"</span><span class="op">)</span><span class="op">)</span> <span class="co"># write output raster to tif</span></code></pre></div>
</div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="lhseval">Latin hypercube sampling evaluation
algorithms<a class="anchor" aria-label="anchor" href="#lhseval"></a>
</h2>
<p>The following 2 algorithms provide a means to maximize the
effectiveness of <a href="#clhs">latin hypercube sampling</a>
protocols.</p>
<div class="section level3 unnumbered">
<h3 class="unnumbered" id="lhspop">
<code>calculate_pop</code><a class="anchor" aria-label="anchor" href="#lhspop"></a>
</h3>
<p>The <code><a href="../reference/calculate_pop.html">calculate_pop()</a></code> function calculates population level
statistics about the <code>mraster</code> covariates being used
including calculating principal components, quantile &amp; covariate
distributions, and Kullbackâ€“Leibler divergence testing. The outputs from
this function are mandatory for use of the
<code><a href="../reference/calculate_lhsOpt.html">calculate_lhsOpt()</a></code> function described in the next section.
This algorithm can also be preemptively used to calculate
<code>matQ</code> and <code>MatCov</code> that will be used in
<code><a href="../reference/sample_ahels.html">sample_ahels()</a></code>.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#--- by default all statistical data are calculated ---#</span>
<span class="fu"><a href="../reference/calculate_pop.html">calculate_pop</a></span><span class="op">(</span>mraster <span class="op">=</span> <span class="va">mraster</span><span class="op">)</span> <span class="co"># input </span></code></pre></div>
<p>The output details the following:</p>
<ul>
<li><p><code>$values</code> - Pixel values from
<code>mraster</code></p></li>
<li><p><code>$pcaLoad</code> - PCA loadings</p></li>
<li><p><code>$matQ</code> - Quantile matrix</p></li>
<li><p><code>$matCov</code> - Covariate matrix</p></li>
</ul>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#--- statistical analyses can be chosen by setting their parameter to `FALSE` ---#</span>
<span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_pop.html">calculate_pop</a></span><span class="op">(</span>mraster <span class="op">=</span> <span class="va">mraster</span>, <span class="co"># input</span>
                     nQuant <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="co"># desired number of quantiles</span>

<span class="co">#--- use matrix output within sample ahels algorithm ---#</span>
<span class="fu"><a href="../reference/sample_ahels.html">sample_ahels</a></span><span class="op">(</span>mraster <span class="op">=</span> <span class="va">mraster</span>, 
             existing <span class="op">=</span> <span class="va">existing</span>, 
             nQuant <span class="op">=</span> <span class="fl">10</span>, 
             nSamp <span class="op">=</span> <span class="fl">50</span>,
             matCov <span class="op">=</span> <span class="va">mat</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3 unnumbered">
<h3 class="unnumbered" id="lhsopt">
<code>calculate_lhsOpt</code><a class="anchor" aria-label="anchor" href="#lhsopt"></a>
</h3>
<p>The <code><a href="../reference/calculate_lhsOpt.html">calculate_lhsOpt()</a></code> function performs a bootsrapped
latin hypercube sampling approach where a population level analysis of
<code>mraster</code> data is performed to determine the optimal Latin
hypercube sample size.</p>
<p>Using statistical data calculated using the
<code><a href="../reference/calculate_pop.html">calculate_pop()</a></code> and varying sample sizes defined by
<code>minSamp</code>, <code>maxSamp</code>, <code>step</code> and
<code>rep</code>. Sampling protocols are conducted and statistical
effectiveness of those sampling outcomes are evaluated to determine
where sample size is minimized and statistical representation is
maximized.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#--- calculate lhsPop details ---#</span>
<span class="va">poplhs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_pop.html">calculate_pop</a></span><span class="op">(</span>mraster <span class="op">=</span> <span class="va">mr</span><span class="op">)</span>

<span class="fu"><a href="../reference/calculate_lhsOpt.html">calculate_lhsOpt</a></span><span class="op">(</span>popLHS <span class="op">=</span> <span class="va">poplhs</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/calculate_lhsOpt.html">calculate_lhsOpt</a></span><span class="op">(</span>popLHS <span class="op">=</span> <span class="va">poplhs</span>, 
                 PCA <span class="op">=</span> <span class="cn">FALSE</span>, 
                 iter <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by
<a href="https://scholar.google.ca/citations?user=C_qdYDsAAAAJ&amp;hl=en" class="external-link">Tristan
RH Goodbody</a>,
<a href="https://forestry.ubc.ca/faculty-profile/nicholas-coops/" class="external-link">Nicholas
C Coops</a>,
<a href="https://www.researchgate.net/profile/Martin-Queinnec" class="external-link">Martin
Queinnec</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a>
2.0.2.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
